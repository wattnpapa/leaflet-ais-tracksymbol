/*! leaflet-ais-tracksymbol 2016-09-13 Copyright by   */
L.TrackLayer=function(){var a=L.featureGroup([]);this.addTrack=function(b){b.addTo(a)},this.removeTrack=function(b){b.removeLayer(a)},this.addTo=function(b){a.addTo(b)}},L.trackLayer=function(){return new L.TrackLayer},L.TrackSymbol=L.Path.extend({initialize:function(a,b){if(L.Path.prototype.initialize.call(this,b),void 0===a)throw Error("Please give a valid lat/lon-position");b=b||{},this._id=b.trackId||0,this._leaflet_id=this._id,this._latlng=L.latLng(a),this._size=b.size||24,this._heading=b.heading,this._course=b.course,this._speed=b.speed,this._leaderTime=b.leaderTime||60,this._minSilouetteZoom=b.minSilouetteZoom||14,this.setGPSRefPos(b.gpsRefPos),this._triSymbol=b.defaultSymbol||[.75,0,-.25,.3,-.25,-.3],this._diaSymbol=b.noHeadingSymbol||[.3,0,0,.3,-.3,0,0,-.3],this._silSymbol=b.silouetteSymbol||[1,.5,.75,1,0,1,0,0,.75,0]},setLatLng:function(a){return this._latlng=L.latLng(a),this.redraw()},setSpeed:function(a){return this._speed=a,this.redraw()},setCourse:function(a){return this._course=a,this.redraw()},setHeading:function(a){return this._heading=a,this.redraw()},setLeaderTime:function(a){return this._leaderTime=a,this.redraw()},setGPSRefPos:function(a){return void 0===a||a.length<4?this._gpsRefPos=void 0:0===a[0]&&0===a[1]&&0===a[2]&&0===a[3]?this._gpsRefPos=void 0:this._gpsRefPos=a,this.redraw()},getTrackId:function(){return this._trackId},_getLatSize:function(){return this._getLatSizeOf(this._size)},_getLngSize:function(){return this._getLngSizeOf(this._size)},_getLatSizeOf:function(a){return a/40075017*360},_getLngSizeOf:function(a){return a/40075017*360/Math.cos(L.LatLng.DEG_TO_RAD*this._latlng.lat)},getBounds:function(){var a=this._getLngSize()/2,b=this._getLatSize()/2,c=this._latlng;return new L.LatLngBounds([c.lat-b,c.lng-a],[c.lat+b,c.lng+a])},getLatLng:function(){return this._latlng},_rotate:function(a,b){var c=a[0],d=a[1],e=Math.sin(b),f=Math.cos(b),g=c*f-d*e,h=c*e+d*f;return[g,h]},_rotateAllPoints:function(a,b){for(var c=[],d=0;d<a.length;d+=2){var e=a[d+0]*this._size,f=a[d+1]*this._size,g=this._rotate([e,f],b);c.push(g[0]),c.push(g[1])}return c},_createLeaderViewPoints:function(a){var b=this._speed*this._leaderTime,c=this._latlng.lng+this._getLngSizeOf(b*Math.cos(a)),d=this._latlng.lat+this._getLatSizeOf(b*Math.sin(a)),e=this._map.latLngToLayerPoint(L.latLng([d,c])),f=this._map.latLngToLayerPoint(this._latlng);return[f.x,f.y,e.x,e.y]},_transformAllPointsToView:function(a){for(var b=[],c=this._map.latLngToLayerPoint(this._latlng),d=0;d<a.length;d+=2){var e=c.x+a[d+0],f=c.y-a[d+1];b.push(e),b.push(f)}return b},_createPathFromPoints:function(a){for(var b,c=0;c<a.length;c+=2){var d=a[c+0],e=a[c+1];void 0===b?b="M "+d+" "+e+" ":b+="L "+d+" "+e+" "}return b+" Z"},_getViewAngleFromModel:function(a){return Math.PI/2-a},_createNoHeadingSymbolPathString:function(){var a=this._transformAllPointsToView(this._rotateAllPoints(this._diaSymbol,0)),b=this._createPathFromPoints(a);if(void 0!==this._course&&void 0!==this._speed){var c=this._getViewAngleFromModel(this._course),d=this._createLeaderViewPoints(c);b+=""+this._createPathFromPoints(d)}return b},_createWithHeadingSymbolPathString:function(){var a=this._getViewAngleFromModel(this._heading),b=this._transformAllPointsToView(this._rotateAllPoints(this._triSymbol,a)),c=this._createPathFromPoints(b);if(void 0!==this._course&&void 0!==this._speed){var d=this._getViewAngleFromModel(this._course),e=this._createLeaderViewPoints(d);c+=""+this._createPathFromPoints(e)}return c},_resizeAndMovePoint:function(a,b,c){return[a[0]*b[0]+c[0],a[1]*b[1]+c[1]]},_getSizeFromGPSRefPos:function(){return[this._gpsRefPos[0]+this._gpsRefPos[1],this._gpsRefPos[2]+this._gpsRefPos[3]]},_getOffsetFromGPSRefPos:function(){return[-this._gpsRefPos[1],-this._gpsRefPos[3]]},_transformSilouetteSymbol:function(){for(var a=this._getViewAngleFromModel(this._heading),b=[],c=this._getSizeFromGPSRefPos(),d=this._getOffsetFromGPSRefPos(),e=0;e<this._silSymbol.length;e+=2){var f=[this._silSymbol[e+0],this._silSymbol[e+1]];f=this._resizeAndMovePoint(f,c,d),f=this._rotate(f,a);var g=this._latlng.lng+this._getLngSizeOf(f[0]),h=this._latlng.lat+this._getLatSizeOf(f[1]),i=this._map.latLngToLayerPoint(L.latLng([h,g]));b.push(i.x),b.push(i.y)}return b},_createSilouetteSymbolPathString:function(){var a=this._transformSilouetteSymbol(),b=this._createPathFromPoints(a);if(void 0!==this._course&&void 0!==this._speed){var c=this._getViewAngleFromModel(this._course),d=this._createLeaderViewPoints(c);b+=""+this._createPathFromPoints(d)}return b},getPathString:function(){return void 0===this._heading?this._createNoHeadingSymbolPathString():void 0===this._gpsRefPos||this._map.getZoom()<=this._minSilouetteZoom?this._createWithHeadingSymbolPathString():this._createSilouetteSymbolPathString()}}),L.trackSymbol=function(a,b){return new L.TrackSymbol(a,b)},L.AISTrackSymbol=L.TrackSymbol.extend({initialize:function(a){L.TrackSymbol.prototype.initialize.call(this,L.latLng(0,0),a),a=a||{},this.setFill(a.fill||!0),this.setFillColor(a.fillColor||"#d3d3d3"),this.setFillOpacity(a.fillOpacity||1),this.setStroke(a.stroke||!0),this.setColor(a.color||"#000000"),this.setOpacity(a.opacity||1),this.setWeight(a.weight||1),this._leaderTime=300,a.course=a.cog||0,this.setName(a.name||""),this.bindLabel(),this.bindPopup("",{className:"ais-track-popup"}),this.bindTracksymbolLabel(),this.addData(a)},addData:function(a){this.setMmsi(a.mmsi),this.setMsgId(a.aisMsgId),a.navigationStatus&&this.setNavigationStatus(a.navigationStatus),a.positionAccuracy&&this.setPositionAccuracy(a.positionAccuracy),a.latitude&&this.setLatitude(a.latitude),a.longitude&&this.setLongitude(a.longitude),this.getLatitude()&&this.getLongitude()&&this.setLatLng(L.latLng(this.getLatitude(),this.getLongitude())),a.rot&&this.setRot(a.rot),a.sog&&this.setSog(a.sog),a.trueHeading&&this.setTrueHeading(a.trueHeading),a.timeStamp&&this.setTimeStamp(a.timeStamp),a.specialManoeuvreIndicator&&this.setSpecialManoeuvreIndicator(a.specialManoeuvreIndicator),a.raimFlag&&this.setRaimFlag(a.raimFlag),a.communicationState&&this.setCommunicationState(a.communicationState),a.aisVersionIndicator&&this.setAisVersionIndicator(a.aisVersionIndicator),a.imoNumber&&this.setImoNumber(a.imoNumber),a.callSign&&this.setCallSign(a.callSign),a.name&&this.setName(a.name),a.typeOfShipAndCargo&&this.setTypeOfShipAndCargo(a.typeOfShipAndCargo),a.referencePositionA&&this.setReferencePositionA(a.referencePositionA),a.referencePositionB&&this.setReferencePositionB(a.referencePositionB),a.referencePositionC&&this.setReferencePositionC(a.referencePositionC),a.referencePositionC&&this.setReferencePositionD(a.referencePositionD),a.typeOfDevice&&this.setTypeOfDevice(a.typeOfDevice),a.eta&&this.setEta(a.eta),a.maxPresentStaticDraught&&this.setMaxPresentStaticDraught(a.maxPresentStaticDraught),a.destination&&this.setDestination(a.destination),a.dte&&this.setDte(a.dte),a.cog&&this.setCog(a.cog),this.getReferencePositions()&&this.setGPSRefPos(this.getReferencePositions()),a.typeOfAtoN&&this.setTypeOfAtoN(a.typeOfAtoN),a.nameOfAtoN&&this.setName(a.nameOfAtoN),a.virtualAtoNFlag&&this.setVirtualAtoNFlag(a.virtualAtoNFlag),a.assignedModeFlag&&this.setAssignedModeFlag(a.assignedModeFlag),a.utcYear&&this.setUTCYear(a.utcYear),a.utcMonth&&this.setUTCMonth(a.utcMonth),a.utcDay&&this.setUTCDay(a.utcDay),a.utcHour&&this.setUTCHour(a.utcHour),a.utcMinute&&this.setUTCMinute(a.utcMinute),a.utcSecond&&this.setUTCSecond(a.utcSecond),this._setNameByMMSITable(),this.setLastUpdate(),this.labelAndPopupUpdate()},labelAndPopupUpdate:function(){this.updateLabelContent(this.getMmsi()+" "+this.getName()),this.getPopup()&&this.getPopup().setContent(this.getPopupContent())},getPopupContent:function(){var a=L.DomUtil.create("div"),b=0!==this.getName().length?this.getName():"MSSI: "+this.getMmsi(),c=L.DomUtil.create("div","ais-popup-header",a);c.innerHTML=b;var d=L.DomUtil.create("div","ais-popup-content",a),e="<table>";e+=this._getTableRow("MSSI",this.getMmsi()),this.getName()&&(e+=this._getTableRow("Name",this.getName())),this.getImoNumber()&&(e+=this._getTableRow("IMO",this.getImoNumber())),this.getCallSign()&&(e+=this._getTableRow("Callsign",this.getCallSign())),this.getSog()&&(e+=this._getTableRow("Speed",this.getSog()," kn | "+this.getSogKmH()+" km/h ")),this.getCogDeg()&&(e+=this._getTableRow("Course",this.getCogDeg(),"&deg;")),this.getTrueHeadingDeg()&&(e+=this._getTableRow("Heading",this.getTrueHeadingDeg(),"&deg;")),this.getDestination()&&(e+=this._getTableRow("Destination",this.getDestination())),this.getEta()&&(e+=this._getTableRow("ETA",this.getEta())),this.getNavigationStatusText()&&(e+=this._getTableRow("Nav. Status",this.getNavigationStatusText())),this.getShipLength()&&(e+=this._getTableRow("Length",this.getShipLength()," m")),this.getShipWidth()&&(e+=this._getTableRow("Width",this.getShipWidth()," m")),this.getTypeOfShipText()&&(e+=this._getTableRow("TypeOfShip",this.getTypeOfShipText())),this.getMaxPresentStaticDraught()&&(e+=this._getTableRow("Draught",this.getMaxPresentStaticDraught()," m")),this.getTypeOfDeviceText()&&(e+=this._getTableRow("TypeOfDevice",this.getTypeOfDeviceText())),this.getUTCTime()&&(e+=this._getTableRow("Time",this.getUTCTime())),this.getTypeOfAtoNText()&&(e+=this._getTableRow("TypeOfAtoN",this.getTypeOfAtoNText())),this.getVirtualAtoNFlagText()&&(e+=this._getTableRow("VirtualAtoN",this.getVirtualAtoNFlagText())),this.getAssignedModeFlagText()&&(e+=this._getTableRow("AssignedMode",this.getAssignedModeFlagText())),e+=this._getTableRow("Last AIS Messsage",this.getLastUpdate()),e+="</table>",d.innerHTML=e;var f=L.DomUtil.create("div","ais-popup-footer",a);return f.innerHTML="More Details on <a href='http://www.marinetraffic.com/en/ais/details/ships/mmsi:"+this.getMmsi()+"' target='_blank'>MarineTraffic.com</a>",a},getPopup:function(){return this._popup},openMarineTraffic:function(){var a=window.open("http://www.marinetraffic.com/en/ais/details/ships/mmsi:"+this.getMmsi(),"_blank");a.focus()},_getTableRow:function(a,b,c){return c||(c=""),b?"<tr><td>"+a+"</td><td>"+b+c+"</td></tr>":""},_setColorByTypeOfDevice:function(){this.setColor("#61380b"),this.setFillColor("#ffffff")},_setColorByTypeOfAtoN:function(){this.setColor("#61380b"),this.setFillColor("#CEF6CE")},_setNameByMMSITable:function(){"undefined"!=typeof MMSI&&MMSI[this.getMmsi()]&&this.setName(MMSI[this.getMmsi()])},_setColorsByTypeOfShip:function(){switch(this.getTypeOfShipAndCargo()){case 0:this.setColor("#000000"),this.setFillColor("#d3d3d3");break;case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:this.setColor("#000000"),this.setFillColor("#d3d3d3");break;case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:this.setColor("#000000"),this.setFillColor("#d3d3d3");break;case 29:this.setColor("#000000"),this.setFillColor("#d3d3d3");break;case 30:this.setColor("#800000"),this.setFillColor("#ffa07a");break;case 31:case 32:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 33:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 34:case 35:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 36:this.setColor("#8b008b"),this.setFillColor("#ff00ff");break;case 37:this.setColor("#8b008b"),this.setFillColor("#ff00ff");break;case 38:case 39:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:this.setColor("#00008b"),this.setFillColor("#ffff00");break;case 50:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 51:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 52:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 53:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 54:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 55:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 56:case 57:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 58:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 59:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;case 60:case 61:case 62:case 63:case 64:case 65:case 66:case 67:case 68:case 69:this.setColor("#00008b"),this.setFillColor("#0000ff");break;case 70:this.setColor("#006400"),this.setFillColor("#90ee90");break;case 71:this.setColor("#006400"),this.setFillColor("#90ee90");break;case 72:this.setColor("#006400"),this.setFillColor("#90ee90");break;case 73:this.setColor("#006400"),this.setFillColor("#90ee90");break;case 74:this.setColor("#006400"),this.setFillColor("#90ee90");break;case 75:case 76:case 77:case 78:case 79:this.setColor("#006400"),this.setFillColor("#90ee90");break;case 80:this.setColor("#8b0000"),this.setFillColor("#ff0000");break;case 81:this.setColor("#8b0000"),this.setFillColor("#ff0000");break;case 82:this.setColor("#8b0000"),this.setFillColor("#ff0000");break;case 83:this.setColor("#8b0000"),this.setFillColor("#ff0000");break;case 84:this.setColor("#8b0000"),this.setFillColor("#ff0000");break;case 85:case 86:case 87:case 88:case 89:this.setColor("#8b0000"),this.setFillColor("#ff0000");break;case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:case 99:this.setColor("#008b8b"),this.setFillColor("#00ffff");break;default:this.setColor("#000000"),this.setFillColor("#d3d3d3")}},getMsgId:function(){return this._msgId},setMsgId:function(a){this._msgId=a},getMmsi:function(){return this._mmsi},setMmsi:function(a){this._mmsi=a,this._leaflet_id=a},getAisVersionIndicator:function(){return this._aisVersionIndicator},setAisVersionIndicator:function(a){this._aisVersionIndicator=a},getImoNumber:function(){return this._imoNumber},setImoNumber:function(a){this._imoNumber=a},getCallSign:function(){return this._callSign},setCallSign:function(a){this._callSign=a},getName:function(){return this._name},setName:function(a){this._name=a},getTypeOfShipAndCargo:function(){return this._typeOfShipAndCargo},setTypeOfShipAndCargo:function(a){this._typeOfShipAndCargo=a,this._setColorsByTypeOfShip()},getTypeOfAtoN:function(){return this._typeOfAtoN},getTypeOfAtoNText:function(){switch(this.getTypeOfAtoN()){case 0:return"Default, Type of AtoN not specified";case 1:return"Reference point";case 2:return"RACON";case 3:return"Fixed structures off-shore";case 4:return"Emergency Wreck Marking Buoy";case 5:return"Light, without sectors";case 6:return"Light, with sectors";case 7:return"Leading Light Front";case 8:return"Leading Light Rear";case 9:return"Beacon, Cardinal N";case 10:return"Beacon, Cardinal E";case 11:return"Beacon, Cardinal S";case 12:return"Beacon, Cardinal W";case 13:return"Beacon, Port hand";case 14:return"Beacon, Starboard hand";case 15:return"Beacon, Preferred Channel port hand";case 16:return"Beacon, Preferred Channel starboard hand";case 17:return"Beacon, Isolated danger";case 18:return"Beacon, Safe water";case 19:return"Beacon, Special mark";case 20:return"Cardinal Mark N";case 21:return"Cardinal Mark E";case 22:return"Cardinal Mark S";case 23:return"Cardinal Mark W";case 24:return"Port hand Mark";case 25:return"Starboard hand Mark";case 26:return"Preferred Channel Port hand";case 27:return"Preferred Channel Starboard hand";case 28:return"Isolated danger";case 29:return"Safe Water";case 30:return"Special Mark";case 31:return"Light Vessel/LANBY/Rigs"}},setTypeOfAtoN:function(a){this._typeOfAtoN=a},getNameOfAtoN:function(){return this._nameOfAtoN},setVirtualAtoNFlag:function(a){this._virtualAtoNFlag=a},getVirtualAtoNFlag:function(){return this._virtualAtoNFlag},getVirtualAtoNFlagText:function(){switch(this.getVirtualAtoNFlag()){case 0:return"real AtoN at indicated position";case 1:return"virtual AtoN, does not physically exist"}},setAssignedModeFlag:function(a){this._assignedModeFlag=a},getAssignedModeFlag:function(){return this._assignedModeFlag},getAssignedModeFlagText:function(){switch(this.getAssignedModeFlag()){case 0:return"Station operating in autonomous and continuous mode";case 1:return"Station operating in assigned mode"}},setNameOfAtoN:function(a){this._nameOfAtoN=a},setUTCYear:function(a){this._utcYear=a},getUTCYear:function(){return this._utcYear},setUTCMonth:function(a){a>=10?this._utcMonth=a:this._utcMonth="0"+a},getUTCMonth:function(){return this._utcMonth},setUTCDay:function(a){a>=10?this._utcDay=a:this._utcDay="0"+a},getUTCDay:function(){return this._utcDay},setUTCHour:function(a){a>=10?this._utcHour=a:this._utcHour="0"+a},getUTCHour:function(){return this._utcHour},setUTCMinute:function(a){a>=10?this._utcMinute=a:this._utcMinute="0"+a},getUTCMinute:function(){return this._utcMinute},setUTCSecond:function(a){a>=10?this._utcSecond=a:this._utcSecond="0"+a},getUTCSecond:function(){return this._utcSecond},getUTCTime:function(){return"undefined"==typeof this.getUTCYear()?null:this.getUTCYear()+"."+this.getUTCMonth()+"."+this.getUTCDay()+" "+this.getUTCHour()+":"+this.getUTCMinute()+":"+this.getUTCSecond()+" UTC"},getTypeOfDevice:function(){return this._typeOfDevice},getTypeOfDeviceText:function(){switch(this.getTypeOfDevice()){case 0:return"undefined (default)";case 1:return"global positioning system (GPS)";case 2:return"GNSS (GLONASS)";case 3:return"combined GPS/GLONASS";case 4:return"Loran-C";case 5:return"Chayka";case 6:return"integrated navigation system";case 7:return"surveyed";case 8:return"Galileo";case 9:case 10:case 11:case 12:case 13:case 14:case 15:return"internal GNSS"}},setTypeOfDevice:function(a){this._typeOfDevice=a},getEta:function(){return this._eta},setEta:function(a){this._eta=a},getMaxPresentStaticDraught:function(){return this._maxPresentStaticDraught},setMaxPresentStaticDraught:function(a){this._maxPresentStaticDraught=a},getDestination:function(){return this._destination},setDestination:function(a){0===a.length&&(a=!1),this._destination=a},getDte:function(){return this._dte},setDte:function(a){this._dte=a},getNavigationStatus:function(){return this._navigationStatus},getNavigationStatusText:function(){switch(this.getNavigationStatus()){case 0:return"under way using engine";case 1:return"at anchor";case 2:return"not under command";case 3:return"restricted manoeuvrability";case 4:return"constrained by her draught";case 5:return"moored";case 6:return"aground";case 7:return"engaged in fishing";case 8:return"under way sailing";case 9:case 10:case 11:return"power-driven vessel towing astern";case 12:return"power-driven vessel pushing ahead or towing alongside";case 13:return"reserved for future use";case 14:return"AIS-SART (active)";case 15:return"undefined"}},setNavigationStatus:function(a){this._navigationStatus=a},getRot:function(){return this._rot},setRot:function(a){this._rot=a},getSogKmH:function(){var a=1.852*this._sog;return a.toFixed(1)},getSog:function(){return this._sog},setSog:function(a){this._sog=a,this.setSpeed(a)},getPositionAccuracy:function(){return this._positionAccuracy},setPositionAccuracy:function(a){this._positionAccuracy=a},getLatitude:function(){return this._latitude},setLatitude:function(a){this._latitude=parseFloat(a)},getLongitude:function(){return this._longitude},setLongitude:function(a){this._longitude=parseFloat(a),this._popup&&this._popup.setLatLng(L.latLng(this.getLatitude(),this.getLongitude())),this.updateTracksymolLabelLatLng(L.latLng(this.getLatitude(),this.getLongitude()))},getLatLng:function(){return L.latLng(this.getLatitude(),this.getLongitude())},getCog:function(){return this._cog},getCogDeg:function(){return Math.round(this.getCog()*(180/Math.PI))},setCog:function(a){this._cog=a,this.setCourse(a)},getTrueHeading:function(){return this._trueHeading},getTrueHeadingDeg:function(){return Math.round(this.getTrueHeading()*(180/Math.PI))},setTrueHeading:function(a){this._trueHeading=a,this.setHeading(a)},getTimeStamp:function(){return this._timeStamp},setTimeStamp:function(a){this._timeStamp=a},getSpecialManoeuvreIndicator:function(){return this._specialManoeuvreIndicator},setSpecialManoeuvreIndicator:function(a){this._specialManoeuvreIndicator=a},getRaimFlag:function(){return this._raimFlag},setRaimFlag:function(a){this._raimFlag=a},getCommunicationState:function(){return this._communicationState},setCommunicationState:function(a){this._communicationState=a},getReferencePositions:function(){return!!(this.getReferencePositionA()&&this.getReferencePositionB()&&this.getReferencePositionC()&&this.getReferencePositionD())&&[this.getReferencePositionA(),this.getReferencePositionB(),this.getReferencePositionC(),this.getReferencePositionD()]},getReferencePositionA:function(){return this._referencePositionA},setReferencePositionA:function(a){this._referencePositionA=a},getReferencePositionB:function(){return this._referencePositionB},setReferencePositionB:function(a){this._referencePositionB=a},getReferencePositionC:function(){return this._referencePositionC},setReferencePositionC:function(a){this._referencePositionC=a},getReferencePositionD:function(){return this._referencePositionD},setReferencePositionD:function(a){this._referencePositionD=a},getShipLength:function(){return this._referencePositionA+this._referencePositionB},getShipWidth:function(){return this._referencePositionC+this._referencePositionD},getTypeOfShipText:function(){switch(this.getTypeOfShipAndCargo()){case 0:return"NOT AVAILABLE OR NO SHIP";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:return"RESERVED";case 20:return"Wing In Grnd";case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:return"Wing In Grnd";case 30:return"Fishing";case 31:case 32:return"Tug";case 33:return"Dredger";case 34:return"Dive Vessel";case 35:return"Military Ops";case 36:return"Sailing Vessel";case 37:return"Pleasure Craft";case 38:case 39:return"RESERVED";case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:return"High-Speed Craft";case 50:return"Pilot Vessel";case 51:return"SAR";case 52:return"Tug";case 53:return"Port Tender";case 54:return"Anti-Pollution";case 55:return"Law Enforce";case 56:case 57:return"Local Vessel";case 58:return"Medical Trans";case 59:return"Special Craft";case 60:case 61:case 62:case 63:case 64:case 65:case 66:case 67:case 68:case 69:return"Passenger";case 70:return"Cargo";case 71:return"Cargo - Hazard A";case 72:return"Cargo - Hazard B";case 73:return"Cargo - Hazard C";case 74:return"Cargo - Hazard D";case 75:case 76:case 77:case 78:case 79:return"Cargo";case 80:return"Tanker";case 81:return"Tanker - Hazard A";case 82:return"Tanker - Hazard B";case 83:return"Tanker - Hazard C";case 84:return"Tanker - Hazard D";case 85:case 86:case 87:case 88:case 89:return"Tanker";case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:case 99:return"Other";default:return"Other"}},getLastUpdate:function(){return this._lastUpdate},setLastUpdate:function(){this._lastUpdate=new Date},setColor:function(a){return this.setStyle({color:a}),this.redraw()},setFillOpacity:function(a){return this.setStyle({fillOpacity:a}),this.redraw()},setOpacity:function(a){return this.setStyle({opacity:a}),this.redraw()},setWeight:function(a){return this.setStyle({weight:a}),this.redraw()},setFill:function(a){return this.setStyle({fill:a}),this.redraw()},setStroke:function(a){return this.setStyle({stroke:a}),this.redraw()},setFillColor:function(a){this.setStyle({fillColor:a})}}),L.aisTrackSymbol=function(a){return new L.AISTrackSymbol(a)},L.AISTrackSymbolLayer=L.LayerGroup.extend({initialize:function(a){L.LayerGroup.prototype.initialize.call(this,a),this._intervalDeadObjs=setInterval(this._checkDeadObjects,1e3,this),this.setRemoveTime(10)},addAisData:function(a){var b,c=a.mmsi;this.getLayer(c)?(b=this.getLayer(c),b.addData(a)):(b=L.aisTrackSymbol({contextmenu:!0,contextmenuItems:[{text:"Details",callback:this.showDetails,index:0},{text:"MarineTraffic.com",callback:this.openMarineTraffic,index:1},{separator:!0,index:2}]}),b.addData(a),this.addLayer(b))},openMarineTraffic:function(a){a.relatedTarget.openMarineTraffic()},showDetails:function(a){a.relatedTarget.openPopup()},_checkDeadObjects:function(a){var b=new Date;a.eachLayer(function(c){b-c.getLastUpdate()>60*a.getRemoveTime()*1e3&&a.removeLayer(c)})},searchTrack:function(a){for(var b=0;b<this.getLayers().length;b++){var c=this.getLayers()[b];if(c.getMmsi()===parseInt(a))return c;if(c.getName().toLowerCase()===a.toLowerCase())return c;if(c.getImoNumber()===parseInt(a))return c}return!1},setRemoveTime:function(a){this._removeMinutes=a},getRemoveTime:function(){return this._removeMinutes}}),L.aisTrackSymbolLayer=function(){return new L.AISTrackSymbolLayer};var LeafletTracksymbolLabel=L.Class.extend({includes:L.Mixin.Events,options:{className:"",clickable:!1,direction:"left",noHide:!0,offset:[12,-15],opacity:1,zoomAnimation:!0},initialize:function(a,b){L.setOptions(this,a),this._source=b,this._animated=L.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(a){this._map=a,this._pane=this.options.pane?a._panes[this.options.pane]:this._source instanceof L.Marker?a._panes.markerPane:a._panes.popupPane,this._container||this._initLayout(),this._pane.appendChild(this._container),this._initInteraction(),this._update(),this.setOpacity(this.options.opacity),a.on("moveend",this._onMoveEnd,this).on("viewreset",this._onViewReset,this),this._animated&&a.on("zoomanim",this._zoomAnimation,this),L.Browser.touch&&!this.options.noHide&&(L.DomEvent.on(this._container,"click",this.close,this),a.on("click",this.close,this))},isOnMap:function(){return!!this._map},onRemove:function(a){this._pane.removeChild(this._container),a.off({zoomanim:this._zoomAnimation,moveend:this._onMoveEnd,viewreset:this._onViewReset},this),this._removeInteraction(),this._map=null},setLatLng:function(a){return this._latlng=L.latLng(a),this._map&&this._updatePosition(),this},setContent:function(a){return this._previousContent=this._content,this._content=a,this._updateContent(),this},close:function(){var a=this._map;a&&(L.Browser.touch&&!this.options.noHide&&(L.DomEvent.off(this._container,"click",this.close),a.off("click",this.close,this)),a.removeLayer(this))},updateZIndex:function(a){this._zIndex=a,this._container&&this._zIndex&&(this._container.style.zIndex=a)},setOpacity:function(a){this.options.opacity=a,this._container&&L.DomUtil.setOpacity(this._container,a)},_initLayout:function(){this._container=L.DomUtil.create("div","leaflet-tracksymbol-label "+this.options.className+" leaflet-zoom-animated"),this.updateZIndex(this._zIndex)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updatePosition(),this._container.style.visibility="")},_updateContent:function(){this._content&&this._map&&this._prevContent!==this._content&&"string"==typeof this._content&&(this._container.innerHTML=this._content,this._prevContent=this._content,this._labelWidth=this._container.offsetWidth)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},_setPosition:function(a){var b=this._map,c=this._container,d=b.latLngToContainerPoint(b.getCenter()),e=b.layerPointToContainerPoint(a),f=this.options.direction,g=this._labelWidth,h=L.point(this.options.offset);"right"===f||"auto"===f&&e.x<d.x?(L.DomUtil.addClass(c,"leaflet-tracksymbol-label-right"),L.DomUtil.removeClass(c,"leaflet-tracksymbol-label-left"),a=a.add(h)):(L.DomUtil.addClass(c,"leaflet-tracksymbol-label-left"),L.DomUtil.removeClass(c,"leaflet-tracksymbol-label-right"),a=a.add(L.point(-h.x-g,h.y))),L.DomUtil.setPosition(c,a)},_zoomAnimation:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPosition(b)},_onMoveEnd:function(){this._animated&&"auto"!==this.options.direction||this._updatePosition()},_onViewReset:function(a){a&&a.hard&&this._update()},_initInteraction:function(){if(this.options.clickable){var a=this._container,b=["dblclick","mousedown","mouseover","mouseout","contextmenu"];L.DomUtil.addClass(a,"leaflet-clickable"),L.DomEvent.on(a,"click",this._onMouseClick,this);for(var c=0;c<b.length;c++)L.DomEvent.on(a,b[c],this._fireMouseEvent,this)}},_removeInteraction:function(){if(this.options.clickable){var a=this._container,b=["dblclick","mousedown","mouseover","mouseout","contextmenu"];L.DomUtil.removeClass(a,"leaflet-clickable"),L.DomEvent.off(a,"click",this._onMouseClick,this);for(var c=0;c<b.length;c++)L.DomEvent.off(a,b[c],this._fireMouseEvent,this)}},_onMouseClick:function(a){this.hasEventListeners(a.type)&&L.DomEvent.stopPropagation(a),this.fire(a.type,{originalEvent:a})},_fireMouseEvent:function(a){this.fire(a.type,{originalEvent:a}),"contextmenu"===a.type&&this.hasEventListeners(a.type)&&L.DomEvent.preventDefault(a),"mousedown"!==a.type?L.DomEvent.stopPropagation(a):L.DomEvent.preventDefault(a)}});L.Map.include({showTracklayerLabel:function(a){return this.addLayer(a)}}),L.Path.include({bindTracksymbolLabel:function(a,b){return this.tracksymbollabel&&this.tracksymbollabel.options===b||(this.tracksymbollabel=new LeafletTracksymbolLabel(b,this)),this.tracksymbollabel.setContent(a),this},unbindTracksymbolLabel:function(){return this.tracksymbollabel&&(this._hideTracksymbolLabel(),this.tracksymbollabel=null),this},updateTracksymbolLabelContent:function(a){this.tracksymbollabel&&("string"==typeof a&&""!==a?(this.tracksymbollabel.isOnMap()||this._showTracksymbolLabel(),this.tracksymbollabel.setContent(a)):this.tracksymbollabel.isOnMap()&&this._hideTracksymbolLabel())},_showTracksymbolLabel:function(){this._map&&this._map.showTracklayerLabel(this.tracksymbollabel)},updateTracksymolLabelLatLng:function(a){this.tracksymbollabel.setLatLng(a)},_hideTracksymbolLabel:function(){this.tracksymbollabel.close()}});